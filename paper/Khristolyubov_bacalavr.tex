\documentclass[12pt, twoside]{article}
\usepackage{jmlda}
\newcommand{\hdir}{.}

\usepackage{dsfont}

\usepackage{csvsimple}

\begin{document}

\title
    [Спектральный анализ в классификации временных рядов] % краткое название; не нужно, если полное название влезает в~колонтитул
    {Спектральный анализ в классификации временных рядов}
\author
    [Максим~Христолюбов, В.\,В.~Стрижов] % список авторов (не более трех) для колонтитула; не нужен, если основной список влезает в колонтитул
    {Максим~Христолюбов, В.\,В.~Стрижов} % основной список авторов, выводимый в оглавление
    [Максим~Христолюбов, В.\,В.~Стрижов] % список авторов, выводимый в заголовок; не нужен, если он не отличается от основного
\thanks
    {}
\organization
    {Московский физико-технический институт}
\abstract
    {В работе решается задача классификации моментов временных рядов на пересекающиеся классы. По временным рядам, снятых с показаний акселлерометра, определяется движение, совершаемое человеком. Исследуется возможность декомпозиции сложных движений на элементарные действия. Для порождения информативных признаков, в пространстве которых происходит классификация и декомпозиция, используется алгоритм SSA "Гусеница".
	
\bigskip
\noindent
\textbf{Ключевые слова}: \emph {временной ряд; классификация; SSA "Гусеница"; локально-аппроксимирующая модель, порождение признаков}
}

\maketitle
\linenumbers

\section{Введение}

Временные ряды являются объектами сложной структуры, требующие предварительной обработки и представления их в удобном для классификации виде. Необходимо отобразить исходный временной ряд в пространство признаков. Например, в \cite{Ivkin15} временной ряд аппроксимируется моделью авторегрессии, а признаками являются ее параметры. В \cite{Karasikov16} качестве аппроксимирующей модели используется модель сингулярного спектра, а признаками являются $k$ наибольших собственных чисел траекторной матрицы участка временного ряда. 

В статье изучается задача классификации движений человека по временным рядам и декомпозиция его движений на элементарные действия. В работе исследуется признаковое описание временных моментов ряда. В качестве признаков для классификации используются собственные числа траекторной матрицы участка ряда, предшествующего моменту времени. Новизна подхода заключается в том, чтобы не просто брать несколько наибольших собственных чисел траекторной матрицы, а учитывать частоты, которым соответствуют эти собственные числа, при классификации. На основе спектрального разложения производится построение пространства описаний элементарных действий.

\section{Постановка задачи}

Задан исходный временной ряд $\mathbf{d}=\{d_i\}_{i=1}^M\in \mathds{R}^M$. Каждому моменту времени $d_i$ соответствует множество меток классов $\mathbf{y}_i\subset Y$, где $|Y|$~---~количество всех классов. Считается, что каждое движение человека представляется, как сумма периодических рядов, причем известен максимальный период $T$.

Требуется решить задачу классификации точек ряда: $$R:\mathcal{I}\rightarrow 2^Y,$$ где $\mathcal{I}=\{1,\ldots M\}$~---~моменты времени, на котором задан временной ряд, а $Y$~---~множество меток классов.

Каждый классифицируемый момент времени $i\in \{2T,\ldots M\}\subset\mathcal{I}$, отобразим с помощью $h:\mathcal{I}\rightarrow \mathds{R}^{2T}$ в временной сегмент $\mathbf{x}_i$ длины $2T$, содержащий локальную информацию о поведении ряда:
\begin{equation}\label{eq1}
h(i) = \mathbf{x}_i = \{d_k\}_{k=i-2T+1}^{i}.
\end{equation}

Полученные сегменты $\mathbf{x} \in \mathbb{X}\subseteq \mathds{R}^{2T}$~---~объекты сложной структуры, представленные временными рядами. Рассматривается задача классификации, а именно восстановление зависимости $$\mathbf{y}=f(\mathbf{x}),$$ где $\mathbf{y}\in Y$. Тогда исходная задача классификации представляет собой $R=f\circ h$.

Данная постановка задачи естественным образом обобщается на случай, когда движения человека описываются $S$ временными рядами с общими моментами времени $\mathcal{I}$. Этот случай отличается только тем, что компонентами временного ряда $\mathbf{x}_i$ являются векторы $\{x_i^{(s)}\}_{s=1}^S$

Классификация временных рядов $\mathbf{x}$ производится в пространстве признаков, порожденных с помощью алгоритма многомерной "Гусеницы"\ MSSA-L. Задача алгоритма MSSA-L состоит в представлении временного ряда в виде суммы интерпретируемых компонент. Поставим в соответствие временному ряду $\mathbf{x}$ его траекторную матрицу Ганкеля $\mathbf{X}\in \mathds{R}^{T\times ST}$:

\begin{equation}\label{eq3}
\mathbf{X} = [\mathbf{X_1}, \mathbf{X_2},\ldots, \mathbf{X_S}],
\end{equation}

где $T$~---~ширина окна, $\mathbf{X_s}\in \mathds{R}^{T\times T}$~---~матрица Ганкеля для ряда $\mathbf{x}^{(s)}$

\begin{equation*}
\mathbf{X^{(s)}} = \left(
\begin{array}{cccc}
x_1^{(s)} & x_2^{(s)} & \ldots & x_T^{(s)}\\
x_2^{(s)} & x_3^{(s)}\ & \ldots & x_{T+1}^{(s)}\\\
\vdots & \vdots & \ddots & \vdots\\
x_T^{(s)} & x_{T+1}^{(s)} & \vdots & x_{2T}^{(s)}\
\end{array}
\right).
\end{equation*}

Ее сингулярное разложение 
\begin{equation}\label{eq3}
\mathbf{X} = \mathbf{U}\diag{\mathbf{h}}\mathbf{V} = \sum\limits_{j=1}^d h_j\mathbf{u_j}\mathbf{v_j^\mathsf{T}},
\end{equation}

где $h_1\ldots h_T$~---~сингулярные числа матрицы $\mathbf{X}$, которые будут использоваться как признаковое описание временного ряда $\mathbf{x}$.

По каждой компоненте в сингулярном разложении определяется его период $\phi_j$:

TODO

Таким образом, каждому временному ряду $\mathbf{x}$ сопоставляется вектор $$\mathbf{h(x)} = \{h_{j}\}_{j=1}^{|\Phi|}\in \mathds{H}$$, где $\Phi$~---~множества всех периодов компонент $\Phi = \{\exists i \in \{2T,\ldots M\}\subset\mathcal{I}: \phi \in index(\mathbf{h}_i)\} $

В качестве гипетезы порождения данных рассматривается следующее предположение: каждой метке класса $y\in Y$ соответствует вектор $\mathbf{h_y}\in \mathds{H}$, а признаки временного ряда $\mathbf{x}$ представляются как сумма 
$$\mathbf{h(x)} = \sum\limits_{y\in f(x)}\mathbf{h_y} + \epsilon,\quad \epsilon = N(0, \sigma^2I_{|Phi|})$$. Составим из $\mathbf{h}_y$ матрицу $\mathbf{H} = (\mathbf{h}_y_1,\ldots \mathbf{h}_y_p$), тогда гипотеза переформулируется в виде 
$$\mathbf{h(x)} = \mathbf{H}\mathbf{y}.$$ Искомая функция $f$ запишется в виде $f(x, H) = \mathbf{H}^{-1}\mathbf{h(x)}$

Пусть после вышеописанных преобразований моментов временного ряда $i\in \mathcal{I}$ получена выборка $\mathfrak{D}=\{(\mathbf{h}_i,\mathbf{y}_i)\}_{i=2T}^{M}$. Задача состоит в нахождении функции матрицы $H$, минимизирующие суммарные потери на выборке $\mathfrak{D}$, при заданной функция потерь вида $$\mathscr{L}(\mathfrak{D}, \mathbf{H}) = \sum\limits_{i=2T}^M \mathscr{L}(\mathbf{h}_i, \mathbf{H}\mathbf{y}_i)$$, характеризующей суммарную ошибку классификации на элементах выборки $\mathfrak{D}$. 

В качестве базовой функции для минимизации рассматривается Средне Квадратичная Ошибка $\mathscr{L} = MSE$.


\section{Вычислительный эксперимент}






\maketitleSecondary
\English
\begin{thebibliography}{99}

\bibitem{McNames}
    \BibAuthor{McNames J.}. 1999.
    Innovations in local modeling for time series prediction // 
    \BibJournal{Ph.D. Thesis, Stanford University}
    
\bibitem{Juravl}
    \BibAuthor{Zhuravlev~U.I, Ryazanov~V.~V., Senko O.~V.}. 2005.
    Recognition. Mathematical methods. Software system. Practical applications. // 
    \BibJournal{Fazis, Moscow}

\bibitem{Ivkin15}
	\BibAuthor{N.~P.~Ivkin, M.~P.~Kuznetsov}. 2015.
	 Time series classification algorithm using combined feature description.
	\BibJournal{Machine Learning and Data Analysis} (11):1471–1483.

\bibitem{Motrenko16}
	\BibAuthor{Strijov~V.V., Motrenko~A.P.}. 2016.
	 Extracting fundamental periods to segment human motion time series.
	\BibJournal{Journal of Biomedical and Health Informatics}  20(6):1466 – 1476.
    
\bibitem{Grabovoy20}
	\BibAuthor{Grabovoy A.V., Strijov V.V}. 2020.
	Quasiperiodic time series clustering for human activity recognition
	\BibJournal{Lobachevskii Journal of Mathematics}
	
\printbibliography
  	     	
\end{thebibliography}


\end{document}